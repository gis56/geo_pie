====================
Конструктор разреза.
====================

Подготовка данных.
------------------


Модуль создает макет разреза из объектов карты которые пересекаются линиям разрезов. Для работы модуля необходимо подготовить данные:

* Линии разреза должны быть линейным слоем ``LineGeometry``. Линий в слое может быть несколько. В атрибутах может быть созданно поле ``String`` с названиями разрезов.
* Профили разреза строятся двумя способами. Основной способ построения профиля по изолиниям. Для этого необходимо подготовить ``LineGeometry`` слой с полем ``Integer`` значений высот. Второй способ строит профиль разреза по высотам из файлов радарного зондирования SRTM_ . Для этого необходимо подготовить файл SRTM_ на соответствующую территорию. Не является обязательным.
* Слой скважин - точечная тема ``PointGeometry``. Атрибутивная таблица должна содержать поля:

  +-------------------+------------+---------------------------------------------------+
  | Назначение поля   |    Тип     | Содержание поля                                   | 
  +===================+============+===================================================+
  | *обязательные поля*                                                                |
  +-------------------+------------+---------------------------------------------------+
  |  Название         | ``String`` | Название скважины                                 |
  +-------------------+------------+---------------------------------------------------+
  |  Данные о глубине | ``String`` | | Глубина скважины ввиде числа или путь к файлу   |
  |                   |            | | **.csv** с данными для изогнутых скважин        |
  +-------------------+------------+---------------------------------------------------+
  |  Высота устья     | ``Float``  | Высотя устья скважины                             |
  +-------------------+------------+---------------------------------------------------+
  | *не обязательные поля*                                                             |
  +-------------------+------------+---------------------------------------------------+
  | ГТН               | ``String`` | | Путь к файлу **.csv** с информацией об          |
  |                   |            | | интервалах перфорации, литологии и прочем       |
  +-------------------+------------+---------------------------------------------------+

* Произвольное количество линейных ``LineGeometry`` или полигональных ``PolygonGeometry`` слоёв с полями для идентификации объектов пересечений.

* Данные о кривизне для изогнутых скважин

    ========  =========  ===============  ========
    № точки   Глубина    Зенитный угол    Азимут
    ========  =========  ===============  ========
      1         10          0,17            0,00
      2         20          0,32           45,00 
      3         30          0,67           90,00
    ...        ...           ...             ...
    ========  =========  ===============  ========

   записать в файл **.csv** в таком виде:

.. code-block:: console

   10;0.17;0
   20;0.32;45
   30;0.67;90
   ...


* Прочие вертикальные данные записать в файл с расширением **.csv** в таком виде:


.. code-block:: console

      [filters]
      12;25;lcode#1
      40;53;lcode#2
      ...
      [litology]
      0;37;lcode#3
      37;65;lcode#4
      ...
      ...

Текст в квадратных скобках будет взят в качестве названия слоя.
Если для интервалов перфорации название в квадратных скобках будет точно соответствовать [``filters``], то скважины с фильтрами получат другой тип для отображения в атрибутивной таблице. ``True`` в поле ``lcode``.


.. note:: Проект карты должен быть в плоских координатах.


.. _SRTM : https://www.earthdata.nasa.gov/data/instruments/srtm/resources  


Ввод данных.
------------


В меню **QGis** выбрать пункт :menuselection:`Вектор  --> Мои скрипты --> Конструктор разреза`. Откроется диалоговое окно:


.. image:: /image/cutdialog.jpg
   :alt: Диалог
   :height: 310px
   :width: 360px
   :align: center


В качестве идентификаторов линий разреза по умолчанию используется ``id`` объекта линии. В диалоговом окне можно выбрать :menuselection:`Поле с названиями разрезов` атрибутивной таблицы слоя линий разрезов.


.. image:: /image/map.jpg
   :alt: Карта
   :height: 300px
   :width: 400px
   :scale: 60 %
   :align: center


Пересечения разрезов отображаются пунктирной линией.
Для идентификации линий разреза можно завести в атрибутивной таблице поле текстового типа. Если такого поля не будет, то в качестве имен будет использованно *id* геометрии.

.. note::

   Слой с линиями разреза обязательный для построения разреза.


При построении профиля рельефа есть два варианта:

1. По точкам пересечения линии разреза и изолиний. Изолинии - линейный слой с числовым полем *Double* в котором находятся высоты.

.. note::

   Слой с изолиниями обязательный для построения разреза.


2. Построение рельефа по файлам радарного зондирования *SRTM*. Слой не обязтельный, но при его наличии пересечения с полигональными темами на разрезе ограничиваются этой линий. 


.. image:: /image/cut.jpg
   :alt: Разрез
   :height: 460px
   :width: 350px
   :scale: 60 %
   :align: center


..  toctree::

..   cutclass

